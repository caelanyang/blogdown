---
title: iOS 网络请求使用服务器缓存控制
author: 杨嘉程
date: '2018-09-17'
slug: ios-use-service-cache-control
categories:
  - Technology
  - iOS
tags:
  - iOS
---
iOS中常用的网络请求框架是 [AFNetworing](https://github.com/AFNetworking/AFNetworking)，项目中一开始使用了猿题库的[YTKNetwork](https://github.com/yuantiku/YTKNetwork)，该框架是对AFNetworking的进一步封装，支持按照指定的时间控制缓存。

不过项目的需求并不需要指定多久的时间来保存缓存数据，而是根据服务器的缓存控制头来确定是否使用缓存，在 YTKNetwork 的文档中并没有与缓存头相关的描述，而且，无论是否在 Request里手动添加 `If-None-Match`缓存头，始终的 code 始终是200。

后面换成直接使用 AFNetworking 直接来请求，发现也是无论是否手动添加缓存头，返回的 code 都是200。（指定的返回策略）

后面在网上搜索查找了很久，发现有人说 iOS 的NSURLSession 在默认缓存策略的设置下 ，是会默认处理服务器返回的缓存控制头的，然后如果是返回304 会产线使用缓存然后回调出来 response，code 是200，但是这个无法直接验证。后来又在 github